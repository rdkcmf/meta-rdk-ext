From 8f8a3dff705fad774a10864a2e3dbcfa9779ceff
From: Haelwenn Monnier
Date: Monday, 25 May
Subject: [PATCH] patch for CVSS severe vulnerability CVE-2020-36254
Upstream-Status: Pending

Signed-off-by: Haelwenn Monnier


Index: dropbear-2019.78/scp.c
===================================================================
--- dropbear-2019.78.orig/scp.c
+++ dropbear-2019.78/scp.c
@@ -935,7 +935,8 @@ sink(int argc, char **argv)
 			size = size * 10 + (*cp++ - '0');
 		if (*cp++ != ' ')
 			SCREWUP("size not delimited");
-		if ((strchr(cp, '/') != NULL) || (strcmp(cp, "..") == 0)) {
+		if (*cp == '\0' || strchr(cp, '/') != NULL ||
+		    strcmp(cp, ".") == 0 || strcmp(cp, "..") == 0) { 
 			run_err("error: unexpected filename: %s", cp);
 			exit(1);
 		}
