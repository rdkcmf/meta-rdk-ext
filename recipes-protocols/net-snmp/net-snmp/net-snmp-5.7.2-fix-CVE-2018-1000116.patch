Date: Aug 06 12:07:08 2018

From: 297c25db32074610f33a4d1a2afddde29d49cf9e Dec 21 06:26:35 2018

Subject: [PATCH] RDKALL-856: net-snmp patch CVE-2018-1000116

	A heap corruption vulnerability was discovered in
	net-snmp, a suite of Simple Network Management Protocol applications, triggered when parsing
	the PDU prior to the authentication process. A remote, unauthenticated
	attacker can take advantage of this flaw to crash the snmpd process
	(causing a denial of service) or, potentially, execute arbitrary code
	with the privileges of the user running snmpd.

	Initially CVE-2015-5621 existed as dont-return-incompletely-parsed-varbinds.patch which is duplicated as
	CVE-2018-1000116; New patch contains few more line added as CVE-2018-1000116.patch

Source: OPENSOURCE


Upstream-Status: Submitted [ https://sourceforge.net/p/net-snmp/bugs/2821/ 
                             https://bugs.debian.org/cgi-bin/bugreport.cgi?att=1;bug=894110;filename=CVE-2018-1000116.patch ]

Signed-off-by: skv01 <Shibu_KV@cable.comcast.com>
---

Index: net-snmp-5.7.2/snmplib/snmp_api.c
===================================================================
--- net-snmp-5.7.2.orig/snmplib/snmp_api.c
+++ net-snmp-5.7.2/snmplib/snmp_api.c
@@ -4355,7 +4355,7 @@ snmp_pdu_parse(netsnmp_pdu *pdu, u_char
      */
     data = asn_parse_header(data, length, &msg_type);
     if (data == NULL)
-        return -1;
+        goto fail;
     DEBUGMSGTL(("dumpv_recv","    Command %s\n", snmp_pdu_type(msg_type)));
     pdu->command = msg_type;
     pdu->flags &= (~UCD_MSG_FLAG_RESPONSE_PDU);
@@ -4501,9 +4501,9 @@ snmp_pdu_parse(netsnmp_pdu *pdu, u_char
         data = snmp_parse_var_op(data, objid, &vp->name_length, &vp->type,
                                  &vp->val_len, &var_val, length);
         if (data == NULL)
-            return -1;
+            goto fail;
         if (snmp_set_var_objid(vp, objid, vp->name_length))
-            return -1;
+            goto fail;
 
         len = MAX_PACKET_LENGTH;
         DEBUGDUMPHEADER("recv", "Value");
